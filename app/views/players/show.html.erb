<% provide(:title, "#{@player.first_name} #{@player.last_name}") %>

<%= render 'layouts/breadcrumbs' %>

<div>
    <h2 class="title"><%= "#{@player.first_name} #{@player.last_name}" %></h2>
</div>
<% if @tournament %>
   <div class="btn remove_btn"><%= link_to "Remove Player from #{@tournament.name}", tournament_player_path(@tournament, @player), method: :delete %></div>
<% end %>
<div class="btn edit_btn"><%= link_to "Edit Player", @tournament ? edit_tournament_player_path(@tournament, @player ) : edit_player_path(@player) %></div>
<div class="btn delete_btn"><%= link_to "Delete Player", @player, confirm: "Did you really mean to delete this player?", method: :delete %></div>
<ul class="detail">
	<li><%= @player.email %></li>
	<li>Skill: <%= @player.skill %></li>
	<li>Matches Won: <%= @player.matches_won %></li>
</ul>
<div class="divider"></div>

<h3 class="subtitle">Tournaments</h3>

<table>
    <thead>
    <tr>
        <th>Tournament Name</th>
        <th># of Players</th>
        <th>Status</th>
        <th>Winner</th>
    </tr>
    </thead>
    <% if @player_tournaments.any? %>
        <tbody>
        <% @player_tournaments.order("created_at DESC").each do |t| %>
            <tr>
                <td><%= link_to t.name, tournament_path(t) %></td>
                <td><%= t.players.count %></td>
                <% temp_id = t.winner_id %>
                <td>
                    <% if temp_id != 0 %>
                        Completed
                    <% else %>
                        <%= t.active ? "Active" : "Inactive"  %>
                    <% end %>
                </td>
                <td>
                    <% if temp_id != 0 %>
                        <% p = Player.find(temp_id) %>
                        <% temp = "#{p.first_name} #{p.last_name}" %>
                        <%= link_to "#{temp}", player_path(p) %>
                    <% end %>
                </td>
            </tr>
        <% end %>
        </tbody>
    <% end %>
</table>

